(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[7],{365:function(e,n,t){e.exports={messages:"ChatPage_messages__3fN7y",message:"ChatPage_message__1ngaY"}},370:function(e,n,t){"use strict";t.r(n),t.d(n,"Chat",(function(){return o})),t.d(n,"Messages",(function(){return i})),t.d(n,"AddMessagesForm",(function(){return m})),t.d(n,"Message",(function(){return d}));var a=t(63),s=t(58),r=t(0),c=t.n(r),u=t(365),l=t.n(u);n.default=function(){return c.a.createElement("div",null,c.a.createElement(o,null))};var o=function(){var e=Object(r.useState)(null),n=Object(s.a)(e,2),t=n[0],a=n[1];return Object(r.useEffect)((function(){var e,n=function(){console.log("CLOSE WS"),setTimeout(t,3e3)};function t(){var t,s;null===(t=e)||void 0===t||t.removeEventListener("close",n),null===(s=e)||void 0===s||s.close(),e=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx"),a(e),e.addEventListener("close",n)}return t(),function(){e.removeEventListener("close",n),e.close()}}),[]),c.a.createElement("div",null,c.a.createElement(i,{wsChannel:t}),c.a.createElement(m,{wsChannel:t}))},i=function(e){var n=e.wsChannel,t=Object(r.useState)([]),u=Object(s.a)(t,2),o=u[0],i=u[1];return Object(r.useEffect)((function(){var e=function(e){i((function(n){return[].concat(Object(a.a)(n),Object(a.a)(JSON.parse(e.data)))}))};return null===n||void 0===n||n.addEventListener("message",e),function(){null===n||void 0===n||n.removeEventListener("message",e)}}),[n]),c.a.createElement("div",{className:l.a.messages},o.map((function(e,n){return c.a.createElement(d,{key:n,message:e})})))},m=function(e){var n=e.wsChannel,t=Object(r.useState)(""),a=Object(s.a)(t,2),u=a[0],l=a[1],o=Object(r.useState)("pending"),i=Object(s.a)(o,2),m=i[0],d=i[1];Object(r.useEffect)((function(){var e=function(){d("ready")};return null===n||void 0===n||n.addEventListener("open",e),function(){null===n||void 0===n||n.removeEventListener("open",e)}}),[n]);return c.a.createElement("div",null,c.a.createElement("textarea",{onChange:function(e){l(e.currentTarget.value)},value:u}),c.a.createElement("button",{disabled:null===n||"ready"!==m,onClick:function(){u&&(null===n||void 0===n||n.send(u),l(""))}},"Send"))},d=function(e){var n=e.message;return c.a.createElement("div",{className:l.a.message},c.a.createElement("img",{src:n.photo}),c.a.createElement("b",null,n.userName),c.a.createElement("span",null,n.message),c.a.createElement("hr",null))}}}]);
//# sourceMappingURL=7.60417584.chunk.js.map